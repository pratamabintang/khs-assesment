@if (open()) {
  <button
    class="fixed inset-0 z-40 bg-black/45 backdrop-blur-[2px] md:hidden"
    type="button"
    aria-label="Close menu"
    (click)="close()"
  ></button>
}

<nav class="fixed top-0 left-0 w-full z-50">
  <!-- full-width background -->
  <div
    class="absolute inset-0 bg-gradient-to-b from-slate-50/95 via-slate-50/80 to-slate-50/40 backdrop-blur"
  ></div>

  <!-- full-width bar (no floating pill) -->
  <div class="relative w-full border-b border-slate-200/70">
    <!-- optional glow, still full width -->
    <div
      class="pointer-events-none absolute -top-24 left-1/2 h-40 w-[720px] -translate-x-1/2 rounded-full bg-gradient-to-r from-indigo-500/20 via-sky-500/15 to-fuchsia-500/20 blur-3xl"
      aria-hidden="true"
    ></div>

    <!-- content container (keeps layout nice, background stays full) -->
    <div class="relative mx-auto max-w-7xl px-3 sm:px-4">
      <div class="h-14 sm:h-16 flex items-center justify-between">
        <div class="group inline-flex items-center gap-2.5 font-semibold tracking-tight">
          <span
            class="relative grid place-items-center size-10 rounded-2xl bg-gradient-to-br from-indigo-500 to-violet-500 text-white shadow-sm overflow-hidden"
            aria-hidden="true"
          >
            @if (logoSrc()) {
              <img [src]="logoSrc()!" alt="" class="h-full w-full object-cover" loading="eager" />
              <span class="absolute inset-0 ring-1 ring-white/30"></span>
            } @else {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M4 7h16" />
                <path d="M4 12h10" />
                <path d="M4 17h16" />
              </svg>
            }
          </span>

          <span class="flex flex-col leading-tight">
            <span class="text-[15px] sm:text-base text-slate-900">{{ brand() }}</span>
            <span class="text-[11px] sm:text-xs font-medium text-slate-500 -mt-0.5">
              {{ subtitle() }}
            </span>
          </span>
        </div>

        <div class="hidden md:flex items-center gap-2">
          <ul class="flex items-center gap-1 text-sm font-semibold">
            @for (l of links(); track l.path) {
              <li>
                <a
                  [routerLink]="l.path"
                  (click)="close()"
                  class="relative inline-flex items-center rounded-2xl px-3.5 py-2 text-slate-700 hover:text-slate-900 hover:bg-white/55 transition-all duration-150"
                  [class.text-slate-900]="isActive(l.path)"
                  [class.bg-white/55]="isActive(l.path)"
                >
                  <span class="relative z-10">{{ l.label }}</span>
                </a>
              </li>
            }
          </ul>

          <div class="h-8 w-px bg-slate-200/70 mx-2"></div>

          <button
            type="button"
            class="group inline-flex items-center gap-2 rounded-2xl px-3.5 py-2 text-sm font-semibold text-slate-900 bg-white/55 ring-1 ring-slate-200/70 shadow-sm hover:bg-white hover:ring-slate-300 hover:shadow-md active:scale-[0.98] active:shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300 transition-all duration-150"
            (click)="logout.emit(); close()"
          >
            <span
              class="grid place-items-center size-8 rounded-xl bg-slate-900 text-white group-hover:bg-slate-800 transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="h-4 w-4"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                <path d="M16 17l5-5-5-5" />
                <path d="M21 12H9" />
              </svg>
            </span>

            Logout

            <span
              class="ml-1 text-slate-400 group-hover:text-slate-600 transition-colors"
              aria-hidden="true"
            >
              →
            </span>
          </button>
        </div>

        <button
          type="button"
          class="md:hidden inline-flex items-center justify-center rounded-2xl p-2 hover:bg-white/60 transition"
          aria-label="Toggle menu"
          [attr.aria-expanded]="open()"
          (click)="toggle()"
        >
          <span
            class="grid place-items-center size-10 rounded-2xl bg-white/60 ring-1 ring-white/50 shadow-sm"
          >
            @if (!open()) {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              >
                <path d="M4 6h16" />
                <path d="M4 12h16" />
                <path d="M4 18h16" />
              </svg>
            } @else {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              >
                <path d="M18 6L6 18" />
                <path d="M6 6l12 12" />
              </svg>
            }
          </span>
        </button>
      </div>

      <div
        class="md:hidden overflow-hidden transition-[max-height,opacity,transform] duration-200 ease-out"
        [class.max-h-0]="!open()"
        [class.opacity-0]="!open()"
        [class.-translate-y-1]="!open()"
        [class.max-h-[560px]]="open()"
        [class.opacity-100]="open()"
        [class.translate-y-0]="open()"
      >
        <div class="pb-4">
          <ul class="mt-3 grid gap-2 text-sm font-semibold">
            @for (l of links(); track l.path) {
              <li>
                <a
                  [routerLink]="l.path"
                  (click)="close()"
                  class="relative flex items-center justify-between rounded-2xl border border-white/50 bg-white/65 px-4 py-3 text-slate-900 hover:bg-white/85 transition-all duration-150"
                  [class.bg-white/85]="isActive(l.path)"
                  [class.ring-1]="isActive(l.path)"
                  [class.ring-slate-200/70]="isActive(l.path)"
                >
                  <span class="truncate">{{ l.label }}</span>
                </a>
              </li>
            }
          </ul>

          <button
            type="button"
            class="mt-3 w-full group inline-flex items-center justify-between rounded-2xl border border-white/50 bg-white/65 px-4 py-3 text-sm font-bold text-slate-900 hover:bg-white hover:shadow-md active:scale-[0.99] focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300 transition-all duration-150"
            (click)="logout.emit(); close()"
          >
            <span class="inline-flex items-center gap-3">
              <span
                class="grid place-items-center size-10 rounded-2xl bg-slate-900 text-white group-hover:bg-slate-800 transition-colors"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  class="h-4 w-4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                  <path d="M16 17l5-5-5-5" />
                  <path d="M21 12H9" />
                </svg>
              </span>
              Logout
            </span>

            <span
              class="text-slate-400 group-hover:text-slate-600 transition-colors"
              aria-hidden="true"
              >→</span
            >
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>

<div class="h-[56px] sm:h-[64px]"></div>
